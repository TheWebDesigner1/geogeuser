<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>World Places AI Mapillary</title>
<style>
  body { font-family: Arial, sans-serif; text-align: center; background: #f5f7fa; }
  input, button { padding: 10px; font-size: 16px; margin: 5px; }
  img { margin-top: 20px; max-width: 90%; border-radius: 10px; }
</style>
</head>
<body>
<h1>World Places AI - Mapillary Images</h1>
<p>Enter a location (lat,lng):</p>
<input type="text" id="location" placeholder="e.g., 48.8584,2.2945">
<button onclick="showImage()">Show Image</button>
<div id="imageContainer"></div>

<script>
const token = "MLY|24342885282051971|f8ffd0abcc4043d5ac2557978969a980";

async function showImage() {
  const loc = document.getElementById("location").value.trim();
  const [lat, lng] = loc.split(",");
  const container = document.getElementById("imageContainer");
  container.innerHTML = "Loading image...";

  if (!lat || !lng) {
    container.innerHTML = "Please enter valid latitude,longitude!";
    return;
  }

  try {
    const res = await fetch(`https://graph.mapillary.com/images?access_token=${token}&fields=id&limit=1&closeto=${lng},${lat}`);
    const data = await res.json();
    if (data.data && data.data.length > 0) {
      const imageId = data.data[0].id;
      const imageUrl = `https://images.mapillary.com/${imageId}/thumb-1024.jpg`;
      container.innerHTML = `<img src="${imageUrl}" alt="Street view">`;
    } else {
      container.innerHTML = "No Mapillary images found at this location.";
    }
  } catch (err) {
    console.error(err);
    container.innerHTML = "Error fetching image!";
  }
}
</script>
</body>
</html>
